#generates possible DMEDA-derivatized naphthenic acids structures

NADMEDA<-function(Cmin,Cmax,Z,On,Sn,Nn,massmin,massmax){

###Define the input variables: The largest Carbon, Oxygen, Sulfur and Nitrogen numbers, Z number and mass range through which to loop.

Cmin <-as.numeric(Cmin)
Cmax <- as.numeric(Cmax)
Z <- as.numeric(Z)
On <- as.numeric(On)
Sn<-as.numeric(Sn)
Nn<-as.numeric(Nn)
massmin <- as.numeric(massmin)
massmax <- as.numeric(massmax)

###Next define matrix with 9 columns of all zeros. This eases the memory handling.

d<-matrix(c(0,0,0,0,0,0,0,0,0),ncol=9)

###Open the nested loop.

for(m in 0:Nn){
for(l in 0:Sn){
for(i in 2:On){
for(j in 2*0:Z){
for(k in Cmin:Cmax){
#The following rule if(k<abs(j)) states that the number of carbons in a possible
#naphthenic acid must be more than the Z number. Z number = -2 means there is
#one ring in the structure. It follows that a 2-carbon structure cannot have a
#ring, but a 3-C structure can have a ring. In the case of this rule being
#violated, the current loop is null and the next loop begins.

if(k<abs(j) | k>(2*k+j)){is.null(k)} else {
a<-12*k+2*k+j+16*i+32*l+14*m
if(a<massmax & a>massmin) d<-rbind(d,c(a+71,a,(a+71-117)%%14,j,k,2*k+j,i,l,m))
}
}

}

}
}
}
colnames(d)<-c("Deriv. Mass","Mass","14-Remainder","Z-number","C","H","O","S","N")
d<-d[-1,]

}
